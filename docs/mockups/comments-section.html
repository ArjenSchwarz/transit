<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transit â€” Task Detail Comments Mockup</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600&display=swap');

  :root {
    --glass-bg: rgba(255, 255, 255, 0.45);
    --glass-bg-hover: rgba(255, 255, 255, 0.55);
    --glass-border: rgba(255, 255, 255, 0.5);
    --glass-shadow: 0 2px 20px rgba(0, 0, 0, 0.06), 0 0 1px rgba(0, 0, 0, 0.1);
    --glass-blur: 40px;
    --text-primary: rgba(0, 0, 0, 0.85);
    --text-secondary: rgba(0, 0, 0, 0.5);
    --text-tertiary: rgba(0, 0, 0, 0.32);
    --accent: #007AFF;
    --accent-soft: rgba(0, 122, 255, 0.08);
    --agent-tint: rgba(155, 89, 182, 0.06);
    --agent-accent: rgba(155, 89, 182, 0.5);
    --agent-icon-bg: rgba(155, 89, 182, 0.1);
    --destructive: #FF3B30;
    --separator: rgba(0, 0, 0, 0.08);
    --input-bg: rgba(0, 0, 0, 0.03);
    --radius: 14px;
    --radius-sm: 10px;
    --radius-xs: 8px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: -apple-system, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Layered gradient background simulating Transit's BoardBackground */
  .app-bg {
    position: fixed;
    inset: 0;
    z-index: -1;
    background:
      radial-gradient(ellipse 80% 60% at 20% 10%, rgba(120, 180, 255, 0.25), transparent 60%),
      radial-gradient(ellipse 70% 50% at 80% 30%, rgba(200, 160, 255, 0.18), transparent 55%),
      radial-gradient(ellipse 60% 70% at 50% 90%, rgba(160, 220, 200, 0.15), transparent 50%),
      linear-gradient(175deg, #f0f2f5 0%, #e8ecf1 40%, #dfe4ec 100%);
  }

  /* Navigation bar */
  .nav-bar {
    position: sticky;
    top: 0;
    z-index: 100;
    padding: 12px 20px;
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(var(--glass-blur)) saturate(1.8);
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(1.8);
    border-bottom: 0.5px solid var(--glass-border);
  }

  .nav-back {
    color: var(--accent);
    font-size: 17px;
    font-weight: 400;
    background: none;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 4px 0;
  }
  .nav-back svg { width: 20px; height: 20px; }

  .nav-title {
    flex: 1;
    text-align: center;
    font-size: 17px;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: -0.2px;
  }

  .nav-action {
    color: var(--accent);
    font-size: 17px;
    font-weight: 400;
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px 0;
    min-width: 44px;
    text-align: right;
  }

  /* Scroll container */
  .scroll-content {
    max-width: 680px;
    margin: 0 auto;
    padding: 20px 16px 100px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  /* Glass card */
  .glass-card {
    background: var(--glass-bg);
    backdrop-filter: blur(var(--glass-blur)) saturate(1.6);
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(1.6);
    border-radius: var(--radius);
    border: 0.5px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
    overflow: hidden;
  }

  /* Form rows */
  .form-row {
    display: flex;
    align-items: center;
    padding: 11px 16px;
    min-height: 44px;
  }
  .form-row + .form-row {
    border-top: 0.5px solid var(--separator);
  }
  .form-label {
    font-size: 15px;
    color: var(--text-primary);
    min-width: 100px;
    font-weight: 400;
  }
  .form-value {
    flex: 1;
    text-align: right;
    font-size: 15px;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 6px;
  }
  .form-value .chevron {
    color: var(--text-tertiary);
    font-size: 13px;
  }

  /* Name input */
  .name-input {
    font-size: 22px;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: -0.4px;
    padding: 14px 16px;
    background: none;
    border: none;
    width: 100%;
    outline: none;
  }
  .name-input::placeholder { color: var(--text-tertiary); }

  /* Description */
  .description-area {
    font-size: 15px;
    color: var(--text-primary);
    padding: 12px 16px;
    background: none;
    border: none;
    width: 100%;
    min-height: 60px;
    outline: none;
    resize: none;
    line-height: 1.45;
    font-family: inherit;
  }
  .description-area::placeholder { color: var(--text-tertiary); }

  /* Status/Type badges */
  .badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 3px 10px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 500;
  }
  .badge-blue { background: rgba(0, 122, 255, 0.12); color: #006FE8; }
  .badge-orange { background: rgba(255, 149, 0, 0.12); color: #C77800; }
  .badge-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
  }
  .badge-dot-blue { background: #007AFF; }
  .badge-dot-orange { background: #FF9500; }

  /* Section header */
  .section-header {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 0 4px;
    margin-bottom: -4px;
  }

  /* â”€â”€ Comments Section â”€â”€ */

  .comments-list {
    display: flex;
    flex-direction: column;
  }

  .comment-item {
    padding: 12px 16px;
    position: relative;
    transition: background 0.15s ease;
  }
  .comment-item + .comment-item {
    border-top: 0.5px solid var(--separator);
  }
  .comment-item:hover {
    background: rgba(0, 0, 0, 0.015);
  }

  /* Agent comment tint */
  .comment-item.agent {
    background: var(--agent-tint);
  }
  .comment-item.agent:hover {
    background: rgba(155, 89, 182, 0.09);
  }

  .comment-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 4px;
  }

  .comment-avatar {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 600;
    flex-shrink: 0;
  }
  .comment-avatar.human {
    background: rgba(0, 122, 255, 0.12);
    color: #006FE8;
  }
  .comment-avatar.agent-avatar {
    background: var(--agent-icon-bg);
    color: rgba(155, 89, 182, 0.8);
  }

  .comment-author {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: -0.1px;
  }

  .comment-agent-label {
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--agent-accent);
    background: var(--agent-icon-bg);
    padding: 1px 5px;
    border-radius: 3px;
  }

  .comment-time {
    font-size: 12px;
    color: var(--text-tertiary);
    margin-left: auto;
  }

  .comment-text {
    font-size: 14px;
    line-height: 1.45;
    color: var(--text-primary);
    padding-left: 30px;
  }

  /* Delete button (appears on hover) */
  .comment-delete {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 26px;
    height: 26px;
    border-radius: 50%;
    border: none;
    background: rgba(255, 59, 48, 0.08);
    color: var(--destructive);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.15s ease, background 0.15s ease;
    font-size: 13px;
  }
  .comment-item:hover .comment-delete {
    opacity: 1;
  }
  .comment-delete:hover {
    background: rgba(255, 59, 48, 0.15);
  }

  /* Comment input area */
  .comment-input-area {
    display: flex;
    align-items: flex-end;
    gap: 8px;
    padding: 10px 12px;
    border-top: 0.5px solid var(--separator);
    background: rgba(0, 0, 0, 0.015);
  }

  .comment-input-wrapper {
    flex: 1;
    background: var(--input-bg);
    border-radius: var(--radius-xs);
    border: 0.5px solid rgba(0, 0, 0, 0.06);
    padding: 8px 12px;
    transition: border-color 0.15s ease, box-shadow 0.15s ease;
  }
  .comment-input-wrapper:focus-within {
    border-color: rgba(0, 122, 255, 0.3);
    box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.08);
  }

  .comment-input {
    font-size: 14px;
    color: var(--text-primary);
    background: none;
    border: none;
    width: 100%;
    outline: none;
    resize: none;
    font-family: inherit;
    line-height: 1.4;
    min-height: 20px;
    max-height: 100px;
  }
  .comment-input::placeholder { color: var(--text-tertiary); }

  .comment-send {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: none;
    background: var(--accent);
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: background 0.15s ease, transform 0.1s ease, opacity 0.15s ease;
    opacity: 0.4;
  }
  .comment-send.active {
    opacity: 1;
  }
  .comment-send.active:hover {
    background: #0066D6;
  }
  .comment-send:active {
    transform: scale(0.92);
  }
  .comment-send svg {
    width: 16px;
    height: 16px;
    margin-left: 1px;
  }

  /* Empty state */
  .empty-state {
    padding: 28px 16px;
    text-align: center;
  }
  .empty-icon {
    font-size: 28px;
    margin-bottom: 8px;
    opacity: 0.25;
  }
  .empty-title {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-tertiary);
    margin-bottom: 2px;
  }
  .empty-subtitle {
    font-size: 12px;
    color: var(--text-tertiary);
    opacity: 0.7;
  }

  /* Delete confirmation toast */
  .toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%) translateY(80px);
    background: rgba(30, 30, 30, 0.88);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    color: white;
    padding: 10px 20px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 500;
    opacity: 0;
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.25s ease;
    pointer-events: none;
    z-index: 200;
  }
  .toast.visible {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
  }

  /* â”€â”€ View Toggle â”€â”€ */

  .toggle-bar {
    display: flex;
    justify-content: center;
    gap: 0;
    padding: 20px 0 4px;
  }
  .toggle-btn {
    font-size: 13px;
    font-weight: 500;
    padding: 6px 16px;
    border: 0.5px solid var(--separator);
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s ease;
  }
  .toggle-btn:first-child { border-radius: 8px 0 0 8px; }
  .toggle-btn:last-child { border-radius: 0 8px 8px 0; }
  .toggle-btn.active {
    background: var(--accent);
    color: white;
    border-color: var(--accent);
  }

  /* â”€â”€ Annotations â”€â”€ */

  .annotation {
    position: fixed;
    z-index: 150;
    max-width: 220px;
    font-size: 12px;
    line-height: 1.4;
    color: var(--text-secondary);
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 8px;
    border: 0.5px solid var(--separator);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }
  .annotations-visible .annotation {
    opacity: 1;
  }
  .annotation strong {
    display: block;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--accent);
    margin-bottom: 2px;
  }
</style>
</head>
<body>
  <div class="app-bg"></div>

  <!-- Toggle between states -->
  <div class="toggle-bar">
    <button class="toggle-btn active" onclick="showState('populated')">With Comments</button>
    <button class="toggle-btn" onclick="showState('empty')">Empty State</button>
  </div>

  <!-- Nav Bar -->
  <div class="nav-bar">
    <button class="nav-back">
      <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
        <path d="M12 4L6 10L12 16"/>
      </svg>
      Tasks
    </button>
    <span class="nav-title">T-46</span>
    <button class="nav-action">Done</button>
  </div>

  <div class="scroll-content">

    <!-- Task Name -->
    <div class="glass-card">
      <input class="name-input" value="Add comments" readonly>
    </div>

    <!-- Description -->
    <div class="glass-card">
      <textarea class="description-area" readonly>Have the ability to add comments. This should be integrated with the MCP as well so that the agent can add comments after it does something.</textarea>
    </div>

    <!-- Status / Type / Project -->
    <div class="glass-card">
      <div class="form-row">
        <span class="form-label">Status</span>
        <span class="form-value">
          <span class="badge badge-blue"><span class="badge-dot badge-dot-blue"></span>Planning</span>
          <span class="chevron">â€º</span>
        </span>
      </div>
      <div class="form-row">
        <span class="form-label">Type</span>
        <span class="form-value">
          <span class="badge badge-orange"><span class="badge-dot badge-dot-orange"></span>Feature</span>
          <span class="chevron">â€º</span>
        </span>
      </div>
      <div class="form-row">
        <span class="form-label">Project</span>
        <span class="form-value">
          Transit
          <span class="chevron">â€º</span>
        </span>
      </div>
    </div>

    <!-- â”€â”€â”€ Comments Section â”€â”€â”€ -->
    <span class="section-header">Comments</span>

    <!-- Populated State -->
    <div class="glass-card" id="state-populated">
      <div class="comments-list">

        <div class="comment-item">
          <div class="comment-header">
            <div class="comment-avatar human">A</div>
            <span class="comment-author">Arjen</span>
            <span class="comment-time">Yesterday, 14:23</span>
          </div>
          <p class="comment-text">Should support both user and agent comments. Author stored as free-form string with user's name from app settings.</p>
          <button class="comment-delete" onclick="deleteComment(this)" title="Delete comment">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M2 2L10 10M10 2L2 10"/></svg>
          </button>
        </div>

        <div class="comment-item agent">
          <div class="comment-header">
            <div class="comment-avatar agent-avatar">
              <svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a2 2 0 0 1 2 2v1h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2V3a2 2 0 0 1 2-2zm0 1.25a.75.75 0 0 0-.75.75v1h1.5V3A.75.75 0 0 0 8 2.25zM5.5 8.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm5 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM5 10.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/></svg>
            </div>
            <span class="comment-author">claude-code</span>
            <span class="comment-agent-label">Agent</span>
            <span class="comment-time">Yesterday, 15:07</span>
          </div>
          <p class="comment-text">Created spec with requirements, design document, and task breakdown. Data model uses a separate Comment entity with string-based author field.</p>
          <button class="comment-delete" onclick="deleteComment(this)" title="Delete comment">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M2 2L10 10M10 2L2 10"/></svg>
          </button>
        </div>

        <div class="comment-item">
          <div class="comment-header">
            <div class="comment-avatar human">A</div>
            <span class="comment-author">Arjen</span>
            <span class="comment-time">Today, 09:15</span>
          </div>
          <p class="comment-text">Looks good. Let's also add a user-facing Shortcut for adding comments.</p>
          <button class="comment-delete" onclick="deleteComment(this)" title="Delete comment">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M2 2L10 10M10 2L2 10"/></svg>
          </button>
        </div>

        <div class="comment-item agent">
          <div class="comment-header">
            <div class="comment-avatar agent-avatar">
              <svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a2 2 0 0 1 2 2v1h2a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2V3a2 2 0 0 1 2-2zm0 1.25a.75.75 0 0 0-.75.75v1h1.5V3A.75.75 0 0 0 8 2.25zM5.5 8.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm5 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM5 10.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/></svg>
            </div>
            <span class="comment-author">orbit</span>
            <span class="comment-agent-label">Agent</span>
            <span class="comment-time">Today, 10:42</span>
          </div>
          <p class="comment-text">Assigned to sprint 3. Implementation blocked until T-45 (description field) ships.</p>
          <button class="comment-delete" onclick="deleteComment(this)" title="Delete comment">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M2 2L10 10M10 2L2 10"/></svg>
          </button>
        </div>

      </div>

      <!-- Input -->
      <div class="comment-input-area">
        <div class="comment-input-wrapper">
          <textarea class="comment-input" id="commentInput" placeholder="Add a comment..." rows="1" oninput="autoResize(this); toggleSend()"></textarea>
        </div>
        <button class="comment-send" id="sendBtn" onclick="addComment()">
          <svg viewBox="0 0 20 20" fill="currentColor"><path d="M3.105 2.29a1 1 0 0 1 1.023-.006l13 7a1 1 0 0 1 0 1.752l-13 7A1 1 0 0 1 2.7 17.106L5.39 10 2.7 2.894a1 1 0 0 1 .405-1.604zM6.536 10.75L4.39 16.21 16.05 10 4.39 3.79l2.147 5.46H11a.75.75 0 0 1 0 1.5H6.536z"/></svg>
        </button>
      </div>
    </div>

    <!-- Empty State -->
    <div class="glass-card" id="state-empty" style="display: none;">
      <div class="empty-state">
        <div class="empty-icon">ðŸ’¬</div>
        <p class="empty-title">No comments yet</p>
        <p class="empty-subtitle">Add a comment to start the conversation</p>
      </div>
      <div class="comment-input-area">
        <div class="comment-input-wrapper">
          <textarea class="comment-input" placeholder="Add a comment..." rows="1" oninput="autoResize(this)"></textarea>
        </div>
        <button class="comment-send">
          <svg viewBox="0 0 20 20" fill="currentColor"><path d="M3.105 2.29a1 1 0 0 1 1.023-.006l13 7a1 1 0 0 1 0 1.752l-13 7A1 1 0 0 1 2.7 17.106L5.39 10 2.7 2.894a1 1 0 0 1 .405-1.604zM6.536 10.75L4.39 16.21 16.05 10 4.39 3.79l2.147 5.46H11a.75.75 0 0 1 0 1.5H6.536z"/></svg>
        </button>
      </div>
    </div>

  </div>

  <!-- Toast -->
  <div class="toast" id="toast">Comment deleted</div>

  <script>
    function showState(state) {
      document.getElementById('state-populated').style.display = state === 'populated' ? 'block' : 'none';
      document.getElementById('state-empty').style.display = state === 'empty' ? 'block' : 'none';
      document.querySelectorAll('.toggle-btn').forEach((btn, i) => {
        btn.classList.toggle('active', (state === 'populated' && i === 0) || (state === 'empty' && i === 1));
      });
    }

    function autoResize(el) {
      el.style.height = 'auto';
      el.style.height = Math.min(el.scrollHeight, 100) + 'px';
    }

    function toggleSend() {
      const input = document.getElementById('commentInput');
      const btn = document.getElementById('sendBtn');
      btn.classList.toggle('active', input.value.trim().length > 0);
    }

    function deleteComment(btn) {
      const item = btn.closest('.comment-item');
      item.style.opacity = '0';
      item.style.maxHeight = item.offsetHeight + 'px';
      item.style.transition = 'opacity 0.2s ease, max-height 0.3s ease 0.1s, padding 0.3s ease 0.1s';
      requestAnimationFrame(() => {
        item.style.maxHeight = '0';
        item.style.padding = '0 16px';
        item.style.overflow = 'hidden';
      });
      setTimeout(() => item.remove(), 400);

      const toast = document.getElementById('toast');
      toast.classList.add('visible');
      setTimeout(() => toast.classList.remove('visible'), 2000);
    }

    function addComment() {
      const input = document.getElementById('commentInput');
      const text = input.value.trim();
      if (!text) return;

      const list = document.querySelector('#state-populated .comments-list');
      const now = new Date();
      const time = `Today, ${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;

      const item = document.createElement('div');
      item.className = 'comment-item';
      item.style.opacity = '0';
      item.style.transform = 'translateY(6px)';
      item.innerHTML = `
        <div class="comment-header">
          <div class="comment-avatar human">A</div>
          <span class="comment-author">Arjen</span>
          <span class="comment-time">${time}</span>
        </div>
        <p class="comment-text">${text.replace(/</g, '&lt;')}</p>
        <button class="comment-delete" onclick="deleteComment(this)" title="Delete comment">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M2 2L10 10M10 2L2 10"/></svg>
        </button>
      `;
      list.appendChild(item);
      requestAnimationFrame(() => {
        item.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
        item.style.opacity = '1';
        item.style.transform = 'translateY(0)';
      });

      input.value = '';
      input.style.height = 'auto';
      toggleSend();
      item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Submit on Enter (Shift+Enter for newline)
    document.querySelectorAll('.comment-input').forEach(el => {
      el.addEventListener('keydown', e => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          if (el.id === 'commentInput') addComment();
        }
      });
    });
  </script>
</body>
</html>
